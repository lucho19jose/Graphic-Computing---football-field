<!DOCTYPE html>
<html lang="en">
<head>
  <title>Football Field</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
  <link type="text/css" rel="stylesheet" href="main.css">
  <link type="text/css" rel="stylesheet" href="css.css">
  <style>
    body {
      background-color: #cce0ff;
      color: #000;
    }
    a {
      color: #080;
    }
  </style>

</head>

<body>
  <div id="info">Simple Football Field<br />
    Verlet integration with relaxed constraints<br />
  </div>
  <div id="loading">
    <div>
     <div>...loading...</div>
     <div class="progress"><div id="progressbar"></div></div>
   </div>
 </div>

 <script type="module">

   import * as THREE from 'https://threejsfundamentals.org/threejs/resources/threejs/r122/build/three.module.js';

   import Stats from './threejs/stats.module.js';
   import { GUI } from './threejs/dat.gui.module.js';

   import {OrbitControls} from 'https://threejsfundamentals.org/threejs/resources/threejs/r122/examples/jsm/controls/OrbitControls.js';

   // Personaje
   import {GLTFLoader} from 'https://threejsfundamentals.org/threejs/resources/threejs/r122/examples/jsm/loaders/GLTFLoader.js';
   import {SkeletonUtils} from 'https://threejsfundamentals.org/threejs/resources/threejs/r122/examples/jsm/utils/SkeletonUtils.js';


      /*
     * Cloth Simulation using a relaxed constraints solver
     */

    // Suggested Readings

    // Advanced Character Physics by Thomas Jakobsen Character
    // http://freespace.virgin.net/hugo.elias/models/m_cloth.htm
    // http://en.wikipedia.org/wiki/Cloth_modeling
    // http://cg.alexandra.dk/tag/spring-mass-system/
    // Real-time Cloth Animation http://www.darwin3d.com/gamedev/articles/col0599.pdf

    const params = {
      enableWind: true,
      showBall: false,
      togglePins: togglePins
    };

    const DAMPING = 0.03;
    const DRAG = 1 - DAMPING;
    const MASS = 0.1;
    const restDistance = 25;

    const xSegs = 10;
    const ySegs = 10;

    const clothFunction = plane(restDistance * xSegs, restDistance * ySegs);

    const cloth = new Cloth(xSegs, ySegs);

    const GRAVITY = 981 * 1.4;
    const gravity = new THREE.Vector3(0, - GRAVITY, 0).multiplyScalar(MASS);


    const TIMESTEP = 18 / 1000;
    const TIMESTEP_SQ = TIMESTEP * TIMESTEP;

    let pins = [];

    const windForce = new THREE.Vector3(0, 0, 0);

    const ballPosition = new THREE.Vector3(0, - 45, 0);
    const ballSize = 40; //60

    const tmpForce = new THREE.Vector3();


    function plane(width, height) {

      return function (u, v, target) {

        const x = (u - 0.5) * width;
        const y = (v + 0.5) * height;
        const z = 0;

        target.set(x, y, z);

      };

    }

    function Particle(x, y, z, mass) {

      this.position = new THREE.Vector3();
      this.previous = new THREE.Vector3();
      this.original = new THREE.Vector3();
      this.a = new THREE.Vector3(0, 0, 0); // acceleration
      this.mass = mass;
      this.invMass = 1 / mass;
      this.tmp = new THREE.Vector3();
      this.tmp2 = new THREE.Vector3();

      // init

      clothFunction(x, y, this.position); // position
      clothFunction(x, y, this.previous); // previous
      clothFunction(x, y, this.original);

    }

    // Force -> Acceleration

    Particle.prototype.addForce = function (force) {

      this.a.add(
        this.tmp2.copy(force).multiplyScalar(this.invMass)
        );

    };


    // Performs Verlet integration

    Particle.prototype.integrate = function (timesq) {

      const newPos = this.tmp.subVectors(this.position, this.previous);
      newPos.multiplyScalar(DRAG).add(this.position);
      newPos.add(this.a.multiplyScalar(timesq));

      this.tmp = this.previous;
      this.previous = this.position;
      this.position = newPos;

      this.a.set(0, 0, 0);

    };


    const diff = new THREE.Vector3();

    function satisfyConstraints(p1, p2, distance) {

      diff.subVectors(p2.position, p1.position);
      const currentDist = diff.length();
      if (currentDist === 0) return; // prevents division by 0
      const correction = diff.multiplyScalar(1 - distance / currentDist);
      const correctionHalf = correction.multiplyScalar(0.5);
      p1.position.add(correctionHalf);
      p2.position.sub(correctionHalf);

    }


    function Cloth(w, h) {

      w = w || 10;
      h = h || 10;
      this.w = w;
      this.h = h;

      const particles = [];
      const constraints = [];

      // Create particles
      for (let v = 0; v <= h; v++) {

        for (let u = 0; u <= w; u++) {

          particles.push(
            new Particle(u / w, v / h, 0, MASS)
            );

        }

      }

      // Structural

      for (let v = 0; v < h; v++) {

        for (let u = 0; u < w; u++) {

          constraints.push([
            particles[index(u, v)],
            particles[index(u, v + 1)],
            restDistance
            ]);

          constraints.push([
            particles[index(u, v)],
            particles[index(u + 1, v)],
            restDistance
            ]);

        }

      }

      for (let u = w, v = 0; v < h; v++) {

        constraints.push([
          particles[index(u, v)],
          particles[index(u, v + 1)],
          restDistance

          ]);

      }

      for (let v = h, u = 0; u < w; u++) {

        constraints.push([
          particles[index(u, v)],
          particles[index(u + 1, v)],
          restDistance
          ]);

      }


      // While many systems use shear and bend springs,
      // the relaxed constraints model seems to be just fine
      // using structural springs.
      // Shear
      // const diagonalDist = Math.sqrt(restDistance * restDistance * 2);


      // for (v=0;v<h;v++) {
      //  for (u=0;u<w;u++) {

      //    constraints.push([
      //      particles[index(u, v)],
      //      particles[index(u+1, v+1)],
      //      diagonalDist
      //    ]);

      //    constraints.push([
      //      particles[index(u+1, v)],
      //      particles[index(u, v+1)],
      //      diagonalDist
      //    ]);

      //  }
      // }


      this.particles = particles;
      this.constraints = constraints;

      function index(u, v) {

        return u + v * (w + 1);

      }

      this.index = index;

    }

    function simulate(now) {

      const windStrength = Math.cos(now / 7000) * 20 + 40;

      windForce.set(Math.sin(now / 2000), Math.cos(now / 3000), Math.sin(now / 1000));
      windForce.normalize();
      windForce.multiplyScalar(windStrength);

      // Aerodynamics forces

      const particles = cloth.particles;

      if (params.enableWind) {

        let indx;
        const normal = new THREE.Vector3();
        const indices = clothGeometry.index;
        const normals = clothGeometry.attributes.normal;

        for (let i = 0, il = indices.count; i < il; i += 3) {

          for (let j = 0; j < 3; j++) {

            indx = indices.getX(i + j);
            normal.fromBufferAttribute(normals, indx);
            tmpForce.copy(normal).normalize().multiplyScalar(normal.dot(windForce));
            particles[indx].addForce(tmpForce);

          }

        }

      }

      for (let i = 0, il = particles.length; i < il; i++) {

        const particle = particles[i];
        particle.addForce(gravity);

        particle.integrate(TIMESTEP_SQ);

      }

      // Start Constraints

      const constraints = cloth.constraints;
      const il = constraints.length;

      for (let i = 0; i < il; i++) {

        const constraint = constraints[i];
        satisfyConstraints(constraint[0], constraint[1], constraint[2]);

      }

      // Ball Constraints

      ballPosition.z = - Math.sin(now / 600) * 90; //+ 40;
      ballPosition.x = Math.cos(now / 400) * 70;
      ballPosition.Y = Math.cos(now / 400) * 0;

      if (params.showBall) {

        sphere.visible = true;

        for (let i = 0, il = particles.length; i < il; i++) {

          const particle = particles[i];
          const pos = particle.position;
          diff.subVectors(pos, ballPosition);
          if (diff.length() < ballSize) {

            // collided
            diff.normalize().multiplyScalar(ballSize);
            pos.copy(ballPosition).add(diff);

          }

        }

      } else {

        sphere.visible = false;

      }


      // Floor Constraints

      for (let i = 0, il = particles.length; i < il; i++) {

        const particle = particles[i];
        const pos = particle.position;
        if (pos.y < - 250) {

          pos.y = - 250;

        }

      }

      // Pin Constraints

      for (let i = 0, il = pins.length; i < il; i++) {

        const xy = pins[i];
        const p = particles[xy];
        p.position.copy(p.original);
        p.previous.copy(p.original);

      }


    }

    /* testing cloth simulation */

    const pinsFormation = [];
    pins = [6];

    pinsFormation.push(pins);

    pins = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
    pinsFormation.push(pins);

    pins = [0];
    pinsFormation.push(pins);

    pins = []; // cut the rope ;)
    pinsFormation.push(pins);

    pins = [0, cloth.w]; // classic 2 pins
    pinsFormation.push(pins);

    pins = pinsFormation[1];

    function togglePins() {

      pins = pinsFormation[~ ~(Math.random() * pinsFormation.length)];

    }

    let container, stats;
    let camera, scene, renderer;

    let clothGeometry;
    let sphere;
    let object;

    // Personajes
    const mixers = [];
    let then = 0;

    init();
    animate( 0 );

    function init(){

      container = document.createElement('div');
      document.body.appendChild(container);

      // scene

      scene = new THREE.Scene();
      scene.background = new THREE.Color(0xcce0ff);
      scene.fog = new THREE.Fog(0xcce0ff, 500, 10000);

      // camera

      camera = new THREE.PerspectiveCamera(30, window.innerWidth / window.innerHeight, 1, 10000);
      camera.position.set(2100, 300, 200); //...near or hear/there camera.position.set(3000, 300, 1300);

      // lights

      scene.add(new THREE.AmbientLight(0x666666));

      const light = new THREE.DirectionalLight(0xdfebff, 1);//look nice with 0B4C5F
      light.position.set(50, 200, 100);
      light.position.multiplyScalar(1.3);

      light.castShadow = true;

      light.shadow.mapSize.width = 1024;
      light.shadow.mapSize.height = 1024;

      const d = 300;

      light.shadow.camera.left = - d;
      light.shadow.camera.right = d;
      light.shadow.camera.top = d;
      light.shadow.camera.bottom = - d;

      light.shadow.camera.far = 1000;

      scene.add(light);

      // Jugadores
      const manager = new THREE.LoadingManager();
      manager.onLoad = initCharacter;

      const progressbarElem = document.querySelector('#progressbar');
      manager.onProgress = (url, itemsLoaded, itemsTotal) => {
        progressbarElem.style.width = `${itemsLoaded / itemsTotal * 100 | 0}%`;
      };

      const models = {
        mountain0: { url: 'https://threejsfundamentals.org/threejs/resources/models/mountain_landscape/scene.gltf' },
        pug:    { url: 'https://threejsfundamentals.org/threejs/resources/models/animals/Pug.gltf' },
        player1:  { url: 'https://threejsfundamentals.org/threejs/resources/models/knight/KnightCharacter.gltf' },
        player2:  { url: 'https://threejsfundamentals.org/threejs/resources/models/knight/KnightCharacter.gltf' },
        player3:  { url: 'https://threejsfundamentals.org/threejs/resources/models/knight/KnightCharacter.gltf' },
        player4:  { url: 'https://threejsfundamentals.org/threejs/resources/models/knight/KnightCharacter.gltf' },
        player5:  { url: 'https://threejsfundamentals.org/threejs/resources/models/knight/KnightCharacter.gltf' },
        player6:  { url: 'https://threejsfundamentals.org/threejs/resources/models/knight/KnightCharacter.gltf' },
        player7: { url: 'https://threejsfundamentals.org/threejs/resources/models/knight/KnightCharacter.gltf' },
        player8: { url: 'https://threejsfundamentals.org/threejs/resources/models/knight/KnightCharacter.gltf' },
        mountain1: { url: 'https://threejsfundamentals.org/threejs/resources/models/mountain_landscape/scene.gltf' },

        Flamingo1:  { url: 'https://threejsfundamentals.org/threejs/resources/models/flamingo/Flamingo.glb' },
        Flamingo2:    { url: 'https://threejsfundamentals.org/threejs/resources/models/flamingo/Flamingo.glb' },
        Flamingo3:  { url: 'https://threejsfundamentals.org/threejs/resources/models/flamingo/Flamingo.glb' },
      };
      {
        //Cargar archivos gltf
        const gltfLoader = new GLTFLoader(manager);
        for (const model of Object.values(models)) {
          gltfLoader.load(model.url, (gltf) => {
           model.gltf = gltf;
         });
        }
      }

      function prepModelsAndAnimations() {
       Object.values(models).forEach(model => {
        const animsByName = {};
        model.gltf.animations.forEach((clip) => {
         animsByName[clip.name] = clip;
       });
        model.animations = animsByName;
      });
     }

     function initCharacter() {
        // hide the loading bar
        const loadingElem = document.querySelector('#loading');
        loadingElem.style.display = 'none';

        prepModelsAndAnimations();

        Object.values(models).forEach((model, ndx) => {
          const clonedScene = SkeletonUtils.clone(model.gltf.scene);
          const root = new THREE.Object3D();

          root.add(clonedScene);
          scene.add(root);
          //Manda derecha
          if (ndx === 0){
            root.position.x = 0;
            root.position.y = -520;
            root.position.z = -7300;
            // Rotacion
            root.rotation.z = 0;
            root.rotation.y = 8;
            root.rotation.x = 0;
            // Escala
            root.scale.x = 20;
            root.scale.y = 20;
            root.scale.z = 20;
          }
          //posicion de los jugadores
          // Mascota
          else if (ndx === 1) {
            // Posicion
            root.position.x = -1050;
            root.position.y = -200;
            root.position.z = 0;
            // Rotacion
            root.rotation.z = 0;
            root.rotation.y = -80;
            root.rotation.x = 0;
          }
          // Arquero derecho
          else if (ndx === 2) {
            // Posicion
            root.position.x = 0;
            root.position.y = -200;
            root.position.z = -1150;
            // Rotacion
            root.rotation.z = 0;
            root.rotation.y = 0;
            root.rotation.x = 0;
          }
          // jugadores derecho
          else if (ndx > 2 && ndx < 6) {
            // Posicion
            root.position.x = -1350 + ndx * 350;
            root.position.y = -200;
            root.position.z = -400;
            // Rotacion
            root.rotation.z = 0;
            root.rotation.y = 0;
            root.rotation.x = 0;
          }
          // Arquero izquierdo
          else if (ndx === 6) {
            // Posicion
            root.position.x = 0;
            root.position.y = -200;
            root.position.z = 1150;
            // Rotacion
            root.rotation.z = 0;
            root.rotation.y = 198;
            root.rotation.x = 0;
          }
          // Jugadores izquiedo
          else if (ndx > 6 && ndx < 10) {
            // Posicion
            root.position.x = -2650 + ndx * 340;
            root.position.y = -200;
            root.position.z = 400;
            // Rotacion
            root.rotation.z = 0;
            root.rotation.y = 198;
            root.rotation.x = 0;
          }
          //MandaÃ±a del fondo
          else if (ndx === 10){
            root.position.x = -7300;
            root.position.y = -520;
            root.position.z = 0;
            // Rotacion
            root.rotation.z = 0;
            root.rotation.y = 8;
            root.rotation.x = 0;
            // Escala
            root.scale.x = 20;
            root.scale.y = 20;
            root.scale.z = 20;
          }
          // Flamingos
          else if (ndx === 11) {
            // Posicion
            root.position.x = -4000;
            root.position.y = 500;
            root.position.z = 0;
            // Rotacion
            root.rotation.z = 0;
            root.rotation.y = 0;
            root.rotation.x = 0;
          }
          else if (ndx === 12) {
            // Posicion
            root.position.x = -400;
            root.position.y = 500;
            root.position.z = -3000;
            // Rotacion
            root.rotation.z = 0;
            root.rotation.y = 0;
            root.rotation.x = 0;
          }
          else if (ndx === 13) {
            // Posicion
            root.position.x = -2200;
            root.position.y = 500;
            root.position.z = -2300;
            // Rotacion
            root.rotation.z = 0;
            root.rotation.y = 0;
            root.rotation.x = 0;
          }
          if (ndx > 10) {
            // Escala
            root.scale.x = 1;
            root.scale.y = 1;
            root.scale.z = 1;
          }
          // Escala
          if (ndx > 0 && ndx < 10) {
            root.scale.x = 30;
            root.scale.y = 30;
            root.scale.z = 30;
          }
          root.receiveShadow = true;
          root.castShadow = true;

          const mixer = new THREE.AnimationMixer(clonedScene);
          const firstClip = Object.values(model.animations)[0];
          if (ndx > 0 && ndx < 10 || ndx > 10) {
            const action = mixer.clipAction(firstClip);
            action.play();
          }
          mixers.push(mixer);
        });
      }
      //end jugadores

      // cloth material

      const loader = new THREE.TextureLoader();
      const clothTexture = loader.load('textures/circuit_pattern.png');
      clothTexture.anisotropy = 16;

      const clothMaterial = new THREE.MeshLambertMaterial({
        map: clothTexture,
        side: THREE.DoubleSide,
        alphaTest: 0.5
      });

      // cloth geometry

      clothGeometry = new THREE.ParametricBufferGeometry(clothFunction, cloth.w, cloth.h);

      // cloth mesh

      object = new THREE.Mesh(clothGeometry, clothMaterial);
      object.position.set(0, 0, 0);
      object.castShadow = true;
      //scene.add(object);

      object.customDepthMaterial = new THREE.MeshDepthMaterial({
        depthPacking: THREE.RGBADepthPacking,
        map: clothTexture,
        alphaTest: 0.5
      });

      // sphere

      const ballGeo = new THREE.SphereBufferGeometry(ballSize, 32, 16);
      const ballMaterial = new THREE.MeshLambertMaterial();

      sphere = new THREE.Mesh(ballGeo, ballMaterial);
      sphere.castShadow = true;
      sphere.receiveShadow = true;
      sphere.visible = false;

      scene.add(sphere);

      // ground
      
      const groundTexture = loader.load('textures/grasslight-big.jpg');
      groundTexture.wrapS = groundTexture.wrapT = THREE.RepeatWrapping;
      groundTexture.repeat.set(25, 25);
      groundTexture.anisotropy = 16;
      groundTexture.encoding = THREE.sRGBEncoding;

      const groundMaterial = new THREE.MeshLambertMaterial({ map: groundTexture });

      let mesh = new THREE.Mesh(new THREE.PlaneBufferGeometry(20000, 20000), groundMaterial);
      mesh.position.y = - 250;
      mesh.rotation.x = - Math.PI / 2;
      mesh.receiveShadow = true;
      scene.add(mesh);

      // poles

      const poleGeo = new THREE.BoxBufferGeometry(5, 375, 5);
      const poleMat = new THREE.MeshLambertMaterial();

      mesh = new THREE.Mesh(poleGeo, poleMat);
      mesh.position.x = - 175;
      mesh.position.y = - 62;
      mesh.position.z = -1500;
      mesh.receiveShadow = true;
      mesh.castShadow = true;
      scene.add(mesh);

      mesh = new THREE.Mesh(poleGeo, poleMat);
      mesh.position.x = 175;
      mesh.position.y = - 62;
      mesh.position.z = -1500;
      mesh.receiveShadow = true;
      mesh.castShadow = true;
      scene.add(mesh);

      mesh = new THREE.Mesh(new THREE.BoxBufferGeometry(355, 5, 5), poleMat);
      mesh.position.y = - 250 + (750 / 2);
      mesh.position.x = 0;
      mesh.position.z = -1500;
      mesh.receiveShadow = true;
      mesh.castShadow = true;
      scene.add(mesh);

      //...las patillas del arco
      const gg = new THREE.BoxBufferGeometry(10, 10, 10);
      mesh = new THREE.Mesh(gg, poleMat);
      mesh.position.y = - 250;
      mesh.position.x = 175;
      mesh.position.z = -1500;
      mesh.receiveShadow = true;
      mesh.castShadow = true;
      scene.add(mesh);

      mesh = new THREE.Mesh(gg, poleMat);
      mesh.position.y = - 250;
      mesh.position.x = - 175;
      mesh.position.z = - 1500;
      mesh.receiveShadow = true;
      mesh.castShadow = true;
      scene.add(mesh);

      //...new poles

      const boxito = new THREE.BoxBufferGeometry(5, 375, 5);
      const policito = new THREE.MeshLambertMaterial();

      mesh = new THREE.Mesh(boxito, policito);
      mesh.position.x = -175;
      mesh.position.y = - 62;
      mesh.position.z = 1500
      mesh.receiveShadow = true;
      mesh.castShadow = true;
      scene.add(mesh);

      mesh = new THREE.Mesh(boxito, policito);
      mesh.position.x = 175;
      mesh.position.y = - 62;
      mesh.position.z = 1500
      mesh.receiveShadow = true;
      mesh.castShadow = true;
      scene.add(mesh);

      mesh = new THREE.Mesh(new THREE.BoxBufferGeometry(355, 5, 5), poleMat);
      mesh.position.y = - 250 + (750 / 2);
      mesh.position.x = 0;
      mesh.position.z = 1500;
      mesh.receiveShadow = true;
      mesh.castShadow = true;
      scene.add(mesh);

      const aaa = new THREE.BoxBufferGeometry(10, 10, 10);
      mesh = new THREE.Mesh(aaa, poleMat);
      mesh.position.y = - 250;
      mesh.position.x = 175;
      mesh.position.z = 1500;
      mesh.receiveShadow = true;
      mesh.castShadow = true;
      scene.add(mesh);

      mesh = new THREE.Mesh(aaa, poleMat);
      mesh.position.y = - 250;
      mesh.position.x = - 175;
      mesh.position.z = 1500;
      mesh.receiveShadow = true;
      mesh.castShadow = true;
      scene.add(mesh);
     //renderer
     
			//------------------------------------------EMERSON------------------------------------

			
			//... pared arco oeste
			const geometrypas = new THREE.BoxGeometry(4300, 1000, 80);
			const cubeMateriapas = new THREE.MeshBasicMaterial({ color: 0x91622C });
			const materialspas = [
				new THREE.MeshBasicMaterial({ map: loader.load('textures/textura.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/textura.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/textura.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/textura.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/textura.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/textura.png') }),
				

				
			];
			var cubepas = new THREE.Mesh(geometrypas, materialspas);

			cubepas.position.x = 0;
			cubepas.position.y = -130;
			cubepas.position.z = -2000;

			scene.add(cubepas);


			//piso arco oeste
			const geometrypias = new THREE.BoxGeometry(4200, 25, 300);
			const cubeMaterialpias = new THREE.MeshBasicMaterial({ color: 0x91622C });
			const materialspias = [
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				

				
			];
			var cubepias = new THREE.Mesh(geometrypias, materialspias);

			cubepias.position.x = 0;
			cubepias.position.y = -250;
			cubepias.position.z = -1800;

			scene.add(cubepias);

      //--piso lateral izquierdo 1 peque;o
			const geometrypias1 = new THREE.BoxGeometry(700, 25, 2200);
			const cubeMaterialpias1 = new THREE.MeshBasicMaterial({ color: 0x91622C });
			const materialspias1 = [
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),	
				
			];
			var cubepias1 = new THREE.Mesh(geometrypias1, materialspias1);
			cubepias1.position.x = 1800;  
			cubepias1.position.y = -260;
			cubepias1.position.z = -600;
			scene.add(cubepias1);
      
      //-piso lateral derecho 1 peque;o
			const geometrypias2 = new THREE.BoxGeometry(700, 25, 2200);
			const cubeMaterialpias2 = new THREE.MeshBasicMaterial({ color: 0x91622C });
			const materialspias2 = [
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				
			];
			var cubepias2 = new THREE.Mesh(geometrypias2, materialspias2);
			cubepias2.position.x = -1800;
			cubepias2.position.y = -260;
			cubepias2.position.z = -600;
			scene.add(cubepias2);

				//... pared arco este
				const geometrypae = new THREE.BoxGeometry(3500, 1000, 80);
				const cubeMateriapae = new THREE.MeshBasicMaterial({ color: 0x91622C });
				const materialspae = [
				new THREE.MeshBasicMaterial({ map: loader.load('textures/textura.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/textura.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/textura.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/textura.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/textura.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/textura.png') }),
				

				
			];
			var cubepae = new THREE.Mesh(geometrypae, materialspae);

			cubepae.position.x = 350;
			cubepae.position.y = -250;
			cubepae.position.z = 5000;

			scene.add(cubepae);

			//piso arco este
			const geometrypiae1 = new THREE.BoxGeometry(4200, 25, 3200);
			const cubeMaterialpiae1 = new THREE.MeshBasicMaterial({ color: 0x91622C });
			const materialspiae1 = [
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				

				
			];
			var cubepiae1 = new THREE.Mesh(geometrypiae1, materialspiae1);

			cubepiae1.position.x = 0;
			cubepiae1.position.y = -250;
			cubepiae1.position.z = 3400;

			scene.add(cubepiae1);


			//----piso peque;o
			const geometrypiae2 = new THREE.BoxGeometry(700, 25, 1000);
			const cubeMaterialpiae2 = new THREE.MeshBasicMaterial({ color: 0x91622C });
			const materialspiae2 = [
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),	
				
			];
			var cubepiae2 = new THREE.Mesh(geometrypiae2, materialspiae2);
			cubepiae2.position.x = 1800;
			cubepiae2.position.y = -260;
			cubepiae2.position.z = 1300;
			scene.add(cubepiae2);

			//------------------------------------POSTES TECHO VEHICULOS---------------------


			//--------POSTE 1
			const geometrypiatv1 = new THREE.BoxGeometry(30, 3700, 30);
			const cubeMaterialpiatv1 = new THREE.MeshBasicMaterial({ color: 0x91622C });
			const materialspiatv1 = [
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),	
				
			];
			var cubepiatv1 = new THREE.Mesh(geometrypiatv1, materialspiatv1);
			cubepiatv1.position.x = 1900;
			cubepiatv1.position.y = -260;
			cubepiatv1.position.z = 2800;
			scene.add(cubepiatv1);


			const geometrypiattv2 = new THREE.BoxGeometry(100, 100, 100);
			const cubeMaterialpiattv2 = new THREE.MeshBasicMaterial({ color: 0x91622C });
			const materialspiattv2 = [
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),	
				
			];
			var cubepiattv2 = new THREE.Mesh(geometrypiattv2, materialspiattv2);
			cubepiattv2.position.x = 1900;
			cubepiattv2.position.y = -260;
			cubepiattv2.position.z = 2800;
			scene.add(cubepiattv2);

			//-------------POSTE 2
			const geometrypiatv3 = new THREE.BoxGeometry(30, 3700, 30);
			const cubeMaterialpiatv3 = new THREE.MeshBasicMaterial({ color: 0x91622C });
			const materialspiatv3 = [
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),	
				
			];
			var cubepiatv3 = new THREE.Mesh(geometrypiatv3, materialspiatv3);
			cubepiatv3.position.x = -1900;
			cubepiatv3.position.y = -260;
			cubepiatv3.position.z = 2800;
			scene.add(cubepiatv3);


			const geometrypiattv4 = new THREE.BoxGeometry(100, 100, 100);
			const cubeMaterialpiattv4 = new THREE.MeshBasicMaterial({ color: 0x91622C });
			const materialspiattv4 = [
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),	
				
			];
			var cubepiattv4 = new THREE.Mesh(geometrypiattv4, materialspiattv4);
			cubepiattv4.position.x = -1900;
			cubepiattv4.position.y = -260;
			cubepiattv4.position.z = 2800;
			scene.add(cubepiattv4);

			//-----------------------------------POSTE 3
					
			const geometrypiatv5 = new THREE.BoxGeometry(30, 3700, 30);
			const cubeMaterialpiatv5 = new THREE.MeshBasicMaterial({ color: 0x91622C });
			const materialspiatv5 = [
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),	
				
			];
			var cubepiatv5 = new THREE.Mesh(geometrypiatv5, materialspiatv5);
			cubepiatv5.position.x = -1900;
			cubepiatv5.position.y = -260;
			cubepiatv5.position.z = 4400;
			scene.add(cubepiatv5);


			const geometrypiattv6 = new THREE.BoxGeometry(100, 100, 100);
			const cubeMaterialpiattv6 = new THREE.MeshBasicMaterial({ color: 0x91622C });
			const materialspiattv6 = [
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),	
				
			];
			var cubepiattv6 = new THREE.Mesh(geometrypiattv6, materialspiattv6);
			cubepiattv6.position.x = -1900;
			cubepiattv6.position.y = -260;
			cubepiattv6.position.z = 4400;
			scene.add(cubepiattv6);

	//-----------------------------------POSTE 4
					
	const geometrypiatv7 = new THREE.BoxGeometry(30, 3700, 30);
			const cubeMaterialpiatv7 = new THREE.MeshBasicMaterial({ color: 0x91622C });
			const materialspiatv7 = [
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),	
				
			];
			var cubepiatv7 = new THREE.Mesh(geometrypiatv7, materialspiatv7);
			cubepiatv7.position.x = 1900;
			cubepiatv7.position.y = -260;
			cubepiatv7.position.z = 4400;
			scene.add(cubepiatv7);


			const geometrypiattv8 = new THREE.BoxGeometry(100, 100, 100);
			const cubeMaterialpiattv8 = new THREE.MeshBasicMaterial({ color: 0x91622C });
			const materialspiattv8 = [
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),	
				
			];
			var cubepiattv8 = new THREE.Mesh(geometrypiattv8, materialspiattv8);
			cubepiattv8.position.x = 1900;
			cubepiattv8.position.y = -260;
			cubepiattv8.position.z = 4400;
			scene.add(cubepiattv8);

			//---------------------------postes  canchiata

		

			//------------poste 1
			const geometrypiatc0 = new THREE.BoxGeometry(40, 500, 40);
			const cubeMaterialpiatc0 = new THREE.MeshBasicMaterial({ color: 0x91622C });
			const materialspiatc0 = [
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),	
				
			];
			var cubepiatc0 = new THREE.Mesh(geometrypiatc0, materialspiatc0);
			cubepiatc0.position.x = 2100;
			cubepiatc0.position.y = 1200;
			cubepiatc0.position.z = -800;
			scene.add(cubepiatc0);


			
			const geometrypiattc1 = new THREE.BoxGeometry(60, 50, 90);
			const cubeMaterialpiattc1 = new THREE.MeshBasicMaterial({ color: 0x91622C });
			const materialspiattc1 = [
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/postevehiculo.png') }),	
				
			];
			var cubepiattc1 = new THREE.Mesh(geometrypiattc1, materialspiattc1);
			cubepiattc1.position.x = 2100;
			cubepiattc1.position.y = 1120;
			cubepiattc1.position.z = -800;
      scene.add(cubepiattc1);
      
      	//------------poste aumento
			var cubepiatc3a = new THREE.Mesh(geometrypiatc0, materialspiatc0);
			cubepiatc3a.position.x = 2100;
			cubepiatc3a.position.y = 1200;
			cubepiatc3a.position.z = -1800;
			scene.add(cubepiatc3a);


			var cubepiattc4a = new THREE.Mesh(geometrypiattc1, materialspiattc1);
			cubepiattc4a.position.x = 2100;
			cubepiattc4a.position.y = 1120;
			cubepiattc4a.position.z = -1800;
      scene.add(cubepiattc4a);
      
      var cubepiatc3a1 = new THREE.Mesh(geometrypiatc0, materialspiatc0);
			cubepiatc3a1.position.x = -2100;
			cubepiatc3a1.position.y = 1200;
			cubepiatc3a1.position.z = -1800;
			scene.add(cubepiatc3a1);


			var cubepiattc4a1 = new THREE.Mesh(geometrypiattc1, materialspiattc1);
			cubepiattc4a1.position.x = -2100;
			cubepiattc4a1.position.y = 1120;
			cubepiattc4a1.position.z = -1800;
			scene.add(cubepiattc4a1);

			//------------poste 2
			var cubepiatc3 = new THREE.Mesh(geometrypiatc0, materialspiatc0);
			cubepiatc3.position.x = 2100;
			cubepiatc3.position.y = 1200;
			cubepiatc3.position.z = 200;
			scene.add(cubepiatc3);


			var cubepiattc4 = new THREE.Mesh(geometrypiattc1, materialspiattc1);
			cubepiattc4.position.x = 2100;
			cubepiattc4.position.y = 1120;
			cubepiattc4.position.z = 200;
			scene.add(cubepiattc4);


			///---poste 3
			var cubepiatc5 = new THREE.Mesh(geometrypiatc0, materialspiatc0);
			cubepiatc5.position.x = 2100;
			cubepiatc5.position.y = 1200;
			cubepiatc5.position.z = 1200;
			scene.add(cubepiatc5);


			var cubepiattc6 = new THREE.Mesh(geometrypiattc1, materialspiattc1);
			cubepiattc6.position.x = 2100;
			cubepiattc6.position.y = 1120;
			cubepiattc6.position.z = 1200;
			scene.add(cubepiattc6);

			///---poste 4
			var cubepiatc7 = new THREE.Mesh(geometrypiatc0, materialspiatc0);
			cubepiatc7.position.x = 2100;
			cubepiatc7.position.y = 1200;
			cubepiatc7.position.z = 2200;
			scene.add(cubepiatc7);


			var cubepiattc8 = new THREE.Mesh(geometrypiattc1, materialspiattc1);
			cubepiattc8.position.x = 2100;
			cubepiattc8.position.y = 1120;
			cubepiattc8.position.z = 2200;
			scene.add(cubepiattc8);

			//------------poste 5
			var cubepiatc9 = new THREE.Mesh(geometrypiatc0, materialspiatc0);
			cubepiatc9.position.x = -2100;
			cubepiatc9.position.y = 1200;
			cubepiatc9.position.z = -800;
			scene.add(cubepiatc9);


			var cubepiattc10 = new THREE.Mesh(geometrypiattc1, materialspiattc1);
			cubepiattc10.position.x = -2100;
			cubepiattc10.position.y = 1120;
			cubepiattc10.position.z = -800;
			scene.add(cubepiattc10);

			//------------poste 6
			var cubepiatc11 = new THREE.Mesh(geometrypiatc0, materialspiatc0);
			cubepiatc11.position.x = -2100;
			cubepiatc11.position.y = 1200;
			cubepiatc11.position.z = 200;
			scene.add(cubepiatc11);


			var cubepiattc12 = new THREE.Mesh(geometrypiattc1, materialspiattc1);
			cubepiattc12.position.x = -2100;
			cubepiattc12.position.y = 1120;
			cubepiattc12.position.z = 200;
			scene.add(cubepiattc12);


			///---poste 7
			var cubepiatc13 = new THREE.Mesh(geometrypiatc0, materialspiatc0);
			cubepiatc13.position.x = -2100;
			cubepiatc13.position.y = 1200;
			cubepiatc13.position.z = 1200;
			scene.add(cubepiatc13);


			var cubepiattc14 = new THREE.Mesh(geometrypiattc1, materialspiattc1);
			cubepiattc14.position.x = -2100;
			cubepiattc14.position.y = 1120;
			cubepiattc14.position.z = 1200;
			scene.add(cubepiattc14);

			///---poste 8
			var cubepiatc15 = new THREE.Mesh(geometrypiatc0, materialspiatc0);
			cubepiatc15.position.x = -2100;
			cubepiatc15.position.y = 1200;
			cubepiatc15.position.z = 2200;
			scene.add(cubepiatc15);


			var cubepiattc16 = new THREE.Mesh(geometrypiattc1, materialspiattc1);
			cubepiattc16.position.x = -2100;
			cubepiattc16.position.y = 1120;
			cubepiattc16.position.z = 2200;
			scene.add(cubepiattc16);

			//------------------------------------------------end-------------------------------------------------


			
			const geometrypiae3 = new THREE.BoxGeometry(700, 25, 2000);
			const cubeMaterialpiae3 = new THREE.MeshBasicMaterial({ color: 0x91622C });
			const materialspiae3 = [
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				
			];
			var cubepiae3 = new THREE.Mesh(geometrypiae3, materialspiae3);
			cubepiae3.position.x = -1800;
			cubepiae3.position.y = -260;
			cubepiae3.position.z = 2100;
			scene.add(cubepiae3)

			//... pared izquierdo
			const geometryti = new THREE.BoxGeometry(80, 2000, 7000);
			const cubeMaterialti = new THREE.MeshBasicMaterial({ color: 0x91622C });
			const materialsti = [
				new THREE.MeshBasicMaterial({ map: loader.load('textures/textura.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/textura.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/textura.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/textura.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/textura.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/textura.png') }),
				

				
			];
			var cubeti = new THREE.Mesh(geometryti, materialsti);

			cubeti.position.x = 2110;
			cubeti.position.y = 90;
			cubeti.position.z = 1500;

			scene.add(cubeti);

			//... pared derecho
			const geometrytd = new THREE.BoxGeometry(80, 2000, 7000);
			const cubeMaterialtd = new THREE.MeshBasicMaterial({ color: 0x91622C });
			const materialstd = [
				new THREE.MeshBasicMaterial({ map: loader.load('textures/textura.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/textura.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/textura.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/textura.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/textura.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/textura.png') }),
				

				
			];
			var cubetd = new THREE.Mesh(geometrytd, materialstd);

			cubetd.position.x = -2110;
			cubetd.position.y = 90;
			cubetd.position.z = 1500;

			scene.add(cubetd);

			//... lateral izquierdo
			//lateral izquierdo 0
			const geometryi0 = new THREE.BoxGeometry(300, 25, 4000);
			const cubeMateriali0 = new THREE.MeshBasicMaterial({ color: 0x91622C });
			const materialsi0 = [
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),

				
			];
			var cubei0 = new THREE.Mesh(geometryi0, materialsi0);
			cubei0.position.x = 1300;
			cubei0.position.y = -260;
			cubei0.position.z = 200;
      scene.add(cubei0);
      
//-----------------------------------------------------------------------------------------------------------TECHOS
const geometrypite1 = new THREE.BoxGeometry(4000, 25, 2800);
			const cubeMaterialpite1 = new THREE.MeshBasicMaterial({ color: 0x91622C });
			const materialspite1 = [
				new THREE.MeshBasicMaterial({ map: loader.load('textures/techo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/techo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/techo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/techo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/techo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/techo.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/techo.png') }),
				

				
			];
			var cubepite1 = new THREE.Mesh(geometrypite1, materialspite1);

			cubepite1.position.x = 0;
			cubepite1.position.y = 1600;
			cubepite1.position.z = 4000;

			scene.add(cubepite1);

//-----------------

const geometryt00 = new THREE.TorusGeometry( 2400, 120, 160, 10, 1* Math.PI);
const materialt00 = new THREE.MeshBasicMaterial( { color: 0xBBC4C5 } );
const torust00 = new THREE.Mesh( geometryt00, materialt00 );

torust00.position.x = 0;
torust00.position.y = 500;
torust00.position.z = -1440;
scene.add( torust00 );


const geometryt110 = new THREE.TorusGeometry( 2400, 120, 160, 10, 1* Math.PI);
const materialt110 = new THREE.MeshBasicMaterial( { color: 0xBBC4C5  } );
const torust110 = new THREE.Mesh( geometryt110, materialt110 );

torust110.position.x = 0;
torust110.position.y =500;
torust110.position.z = -1680;
scene.add( torust110 );


const geometryt220 = new THREE.TorusGeometry( 2400, 120, 160, 10, 1* Math.PI);
const materialt220 = new THREE.MeshBasicMaterial( { color: 0xE13814 } );
const torust220 = new THREE.Mesh( geometryt220, materialt220 );

torust220.position.x = 0;
torust220.position.y =500;
torust220.position.z = -1920;
scene.add( torust220 );


const geometryt330 = new THREE.TorusGeometry( 2400, 120, 160, 10, 1* Math.PI);
const materialt330 = new THREE.MeshBasicMaterial( { color: 0xE13814  } );
const torust330 = new THREE.Mesh( geometryt330, materialt330 );

torust330.position.x = 0;
torust330.position.y =500;
torust330.position.z = -2160;
scene.add( torust330 );

//----------------

const geometryt0 = new THREE.TorusGeometry( 2400, 120, 160, 10, 1* Math.PI);
const materialt0 = new THREE.MeshBasicMaterial( { color: 0xE13814 } );
const torust0 = new THREE.Mesh( geometryt0, materialt0 );

torust0.position.x = 0;
torust0.position.y = 500;
torust0.position.z = -1200;
scene.add( torust0 );

const geometryt1 = new THREE.TorusGeometry( 2400, 120, 160, 10, 1* Math.PI);
const materialt1 = new THREE.MeshBasicMaterial( { color: 0xE13814  } );
const torust1 = new THREE.Mesh( geometryt1, materialt1 );

torust1.position.x = 0;
torust1.position.y =500;
torust1.position.z = -960;
scene.add( torust1 );


const geometryt2 = new THREE.TorusGeometry( 2400, 120, 160, 10, 1* Math.PI);
const materialt2 = new THREE.MeshBasicMaterial( { color: 0xBBC4C5 } );
const torust2 = new THREE.Mesh( geometryt2, materialt2 );

torust2.position.x = 0;
torust2.position.y =500;
torust2.position.z = -720;
scene.add( torust2 );


const geometryt3 = new THREE.TorusGeometry( 2400, 120, 160, 10, 1* Math.PI);
const materialt3 = new THREE.MeshBasicMaterial( { color: 0xBBC4C5  } );
const torust3 = new THREE.Mesh( geometryt3, materialt3 );

torust3.position.x = 0;
torust3.position.y =500;
torust3.position.z = -480;
scene.add( torust3 );

const geometryt4 = new THREE.TorusGeometry( 2400, 120, 160, 10, 1* Math.PI);
const materialt4 = new THREE.MeshBasicMaterial( { color: 0xE13814 } );
const torust4 = new THREE.Mesh( geometryt4, materialt4 );

torust4.position.x = 0;
torust4.position.y = 500;
torust4.position.z = -240;
scene.add( torust4 );

//

const geometryt5 = new THREE.TorusGeometry( 2400, 120, 160, 10, 1* Math.PI);
const materialt5 = new THREE.MeshBasicMaterial( { color: 0xE13814 } );
const torust5 = new THREE.Mesh( geometryt5, materialt5 );

torust5.position.x = 0;
torust5.position.y =500;
torust5.position.z = 0;
scene.add( torust5 );


const geometryt6 = new THREE.TorusGeometry( 2400, 120, 160, 10, 1* Math.PI);
const materialt6 = new THREE.MeshBasicMaterial( { color: 0xBBC4C5 } );
const torust6 = new THREE.Mesh( geometryt6, materialt6 );

torust6.position.x = 0;
torust6.position.y =500;
torust6.position.z = 240;
scene.add( torust6 );


const geometryt7 = new THREE.TorusGeometry( 2400, 120, 160, 10, 1* Math.PI);
const materialt7 = new THREE.MeshBasicMaterial( { color: 0xBBC4C5  } );
const torust7 = new THREE.Mesh( geometryt7, materialt7 );

torust7.position.x = 0;
torust7.position.y =500;
torust7.position.z = 480;
scene.add( torust7 );

const geometryt8 = new THREE.TorusGeometry( 2400, 120, 160, 10, 1* Math.PI);
const materialt8 = new THREE.MeshBasicMaterial( { color: 0xE13814 } );
const torust8 = new THREE.Mesh( geometryt8, materialt8 );

torust8.position.x = 0;
torust8.position.y = 500;
torust8.position.z = 720;
scene.add( torust8 );

//

const geometryt9 = new THREE.TorusGeometry( 2400, 120, 160, 10, 1* Math.PI);
const materialt9 = new THREE.MeshBasicMaterial( { color: 0xE13814  } );
const torust9 = new THREE.Mesh( geometryt9, materialt9 );

torust9.position.x = 0;
torust9.position.y =500;
torust9.position.z = 960;
scene.add( torust9 );


const geometryt10 = new THREE.TorusGeometry( 2400, 120, 160, 10, 1* Math.PI);
const materialt10 = new THREE.MeshBasicMaterial( { color: 0xBBC4C5 } );
const torust10 = new THREE.Mesh( geometryt10, materialt10 );

torust10.position.x = 0;
torust10.position.y =500;
torust10.position.z = 1200;
scene.add( torust10 );


const geometryt11 = new THREE.TorusGeometry( 2400, 120, 160, 10, 1* Math.PI);
const materialt11 = new THREE.MeshBasicMaterial( { color: 0xBBC4C5  } );
const torust11 = new THREE.Mesh( geometryt11, materialt11 );

torust11.position.x = 0;
torust11.position.y =500;
torust11.position.z = 1440;
scene.add( torust11 );

///------------
const geometryt12 = new THREE.TorusGeometry( 2400, 120, 160, 10, 1* Math.PI);
const materialt12 = new THREE.MeshBasicMaterial( { color: 0xE13814 } );
const torust12 = new THREE.Mesh( geometryt12, materialt12 );

torust12.position.x = 0;
torust12.position.y = 500;
torust12.position.z = 1680;
scene.add( torust12 );

//

const geometryt13 = new THREE.TorusGeometry( 2400, 120, 160, 10, 1* Math.PI);
const materialt13 = new THREE.MeshBasicMaterial( { color: 0xE13814  } );
const torust13 = new THREE.Mesh( geometryt13, materialt13 );

torust13.position.x = 0;
torust13.position.y =500;
torust13.position.z = 1920;
scene.add( torust13 );


const geometryt14 = new THREE.TorusGeometry( 2400, 120, 160, 10, 1* Math.PI);
const materialt14 = new THREE.MeshBasicMaterial( { color: 0xBBC4C5 } );
const torust14 = new THREE.Mesh( geometryt14, materialt14 );

torust14.position.x = 0;
torust14.position.y =500;
torust14.position.z = 2160;
scene.add( torust14 );


const geometryt15 = new THREE.TorusGeometry( 2400, 120, 160, 10, 1* Math.PI);
const materialt15 = new THREE.MeshBasicMaterial( { color: 0xBBC4C5  } );
const torust15 = new THREE.Mesh( geometryt15, materialt15 );

torust15.position.x = 0;
torust15.position.y =500;
torust15.position.z = 2400;
scene.add( torust15 );

const geometryt16 = new THREE.TorusGeometry( 2400, 120, 160, 10, 1* Math.PI);
const materialt16 = new THREE.MeshBasicMaterial( { color: 0xE13814 } );
const torust16 = new THREE.Mesh( geometryt16, materialt16 );

torust16.position.x = 0;
torust16.position.y = 500;
torust16.position.z = 2640;
scene.add( torust16 );

//

const geometryt17 = new THREE.TorusGeometry( 2400, 120, 160, 10, 1* Math.PI);
const materialt17 = new THREE.MeshBasicMaterial( { color: 0xE13814 } );
const torust17 = new THREE.Mesh( geometryt17, materialt17 );

torust17.position.x = 0;
torust17.position.y =500;
torust17.position.z = 2880;
scene.add( torust17 );
//----------------------------------------------------------------------------------------------------------------------------------

			//lateral izquierdo 1
			const geometryi1 = new THREE.BoxGeometry(100, 100, 2500);
			const cubeMateriali1 = new THREE.MeshBasicMaterial({ color: 0xFDE915 });
			var cubei1 = new THREE.Mesh(geometryi1, cubeMateriali1);

			cubei1.position.x = 1500;
			cubei1.position.y = -230;
			cubei1.position.z = 0;

			scene.add(cubei1);

			//lateral izquierdo 2
			const geometryi2 = new THREE.BoxGeometry(100, 150, 2500);
			const cubeMateriali2 = new THREE.MeshBasicMaterial({ color: 0xFDE915 });
			var cubei2 = new THREE.Mesh(geometryi2, cubeMateriali2);

			cubei2.position.x = 1600;
			cubei2.position.y = -190;
			cubei2.position.z = 0;

			scene.add(cubei2);

			//lateral izquierdo 3
			const geometryi3 = new THREE.BoxGeometry(100, 200, 2500);
			const cubeMateriali3 = new THREE.MeshBasicMaterial({ color: 0xEB671D });
			var cubei3 = new THREE.Mesh(geometryi3, cubeMateriali3);

			cubei3.position.x = 1700;
			cubei3.position.y = -150;
			cubei3.position.z = 0;

			scene.add(cubei3);

			//lateral izquierdo 4
			const geometryi4 = new THREE.BoxGeometry(100, 250, 2500);
			const cubeMateriali4 = new THREE.MeshBasicMaterial({ color: 0xEB671D });
			var cubei4 = new THREE.Mesh(geometryi4, cubeMateriali4);

			cubei4.position.x = 1800;
			cubei4.position.y = -130;
			cubei4.position.z = 0;

			scene.add(cubei4);

			//lateral izquierdo 5
			const geometryi5 = new THREE.BoxGeometry(100, 300, 2500);
			const cubeMateriali5 = new THREE.MeshBasicMaterial({ color: 0xE21618});
			var cubei5 = new THREE.Mesh(geometryi5, cubeMateriali5);

			cubei5.position.x = 1900;
			cubei5.position.y = -110;
			cubei5.position.z = 0;

			scene.add(cubei5);

			//lateral izquierdo 6
			const geometryi6 = new THREE.BoxGeometry(100, 350, 2500);
			const cubeMateriali6 = new THREE.MeshBasicMaterial({ color: 0xE21618});
			var cubei6 = new THREE.Mesh(geometryi6, cubeMateriali6);

			cubei6.position.x = 2000;
			cubei6.position.y = -90;
			cubei6.position.z = 0;

			scene.add(cubei6);


			//lateral derecho
       //lateral derecho 0
        
				const geometryd0 = new THREE.BoxGeometry(300,25, 5000);
			const cubeMateriald0 = new THREE.MeshBasicMaterial({ color: 0x91622C });
			const materialsd0 = [
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				new THREE.MeshBasicMaterial({ map: loader.load('textures/texturapiso.png') }),
				

				
			];
			var cubed0 = new THREE.Mesh(geometryd0, materialsd0);

			cubed0.position.x = -1300;
			cubed0.position.y = -260;
			cubed0.position.z = 750;

			scene.add(cubed0);

			//lateral derecho 1
			const geometryd1 = new THREE.BoxGeometry(100, 100, 2500);
			const cubeMateriald1 = new THREE.MeshBasicMaterial({ color: 0xFDE915 });
			var cubed1 = new THREE.Mesh(geometryd1, cubeMateriald1);

			cubed1.position.x = -1500;
			cubed1.position.y = -230;
			cubed1.position.z = 0;

			scene.add(cubed1);

			//lateral derecho 2
			const geometryd2 = new THREE.BoxGeometry(100, 150, 2500);
			const cubeMateriald2 = new THREE.MeshBasicMaterial({ color: 0xFDE915 });
			var cubed2 = new THREE.Mesh(geometryd2, cubeMateriald2);

			cubed2.position.x = -1600;
			cubed2.position.y = -190;
			cubed2.position.z = 0;

			scene.add(cubed2);

			//lateral derecho 3
			const geometryd3 = new THREE.BoxGeometry(100, 200, 2500);
			const cubeMateriald3 = new THREE.MeshBasicMaterial({ color: 0xEB671D });
			var cubed3 = new THREE.Mesh(geometryd3, cubeMateriald3);

			cubed3.position.x = -1700;
			cubed3.position.y = -150;
			cubed3.position.z = 0;

			scene.add(cubed3);

			//lateral derecho 4
			const geometryd4 = new THREE.BoxGeometry(100, 250, 2500);
			const cubeMateriald4 = new THREE.MeshBasicMaterial({ color: 0xEB671D });
			var cubed4 = new THREE.Mesh(geometryd4, cubeMateriald4);

			cubed4.position.x = -1800;
			cubed4.position.y = -130;
			cubed4.position.z = 0;

			scene.add(cubed4);

			//lateral derecho 5
			const geometryd5 = new THREE.BoxGeometry(100, 300, 2500);
			const cubeMateriald5 = new THREE.MeshBasicMaterial({ color: 0xE21618});
			var cubed5 = new THREE.Mesh(geometryd5, cubeMateriald5);

			cubed5.position.x = -1900;
			cubed5.position.y = -110;
			cubed5.position.z = 0;

			scene.add(cubed5);

			//lateral derecho 6
			const geometryd6 = new THREE.BoxGeometry(100, 350, 2500);
			const cubeMateriald6 = new THREE.MeshBasicMaterial({ color: 0xE21618});
			var cubed6 = new THREE.Mesh(geometryd6, cubeMateriald6);

			cubed6.position.x = -2000;
			cubed6.position.y = -90;
			cubed6.position.z = 0;

			scene.add(cubed6);




      renderer = new THREE.WebGLRenderer({ antialias: true });
      renderer.setPixelRatio(window.devicePixelRatio);
      renderer.setSize(window.innerWidth, window.innerHeight);

      container.appendChild(renderer.domElement);

      renderer.outputEncoding = THREE.sRGBEncoding;

      renderer.shadowMap.enabled = true;

      //...lines
      const materialLine = new THREE.LineBasicMaterial({
        color: 0xffffff
      });

      const points = [];
      points.push(new THREE.Vector3(- 1000, -250, -1500));
      points.push(new THREE.Vector3(1000, -250, -1500));
      points.push(new THREE.Vector3(1000, -250, 1500));//...lateral left up point
      points.push(new THREE.Vector3(-1000, -250, 1500));
      points.push(new THREE.Vector3(-1000, -250, -1500));//line lateral right
      //...center line
      points.push(new THREE.Vector3(-1000, -250, 0));
      points.push(new THREE.Vector3(1000, -250, 0));
      //area field
      //points.push(new THREE.Vector3(1000, -250, -1500));
      //points.push(new THREE.Vector3(400, -250, -1500));
      //points.push(new THREE.Vector3(400, -250, -1200));
      //points.push(new THREE.Vector3(-400, -250, -1200));
      //points.push(new THREE.Vector3(-400, -250, -1500));

      const geometryLine = new THREE.BufferGeometry().setFromPoints(points);

      const line = new THREE.Line(geometryLine, materialLine);
      scene.add(line);

      //...circle
      const geometryCircle = new THREE.CircleBufferGeometry(100, 32, 90, 45);
      const materialCircle = new THREE.LineBasicMaterial({ color: 0xffff00 });
      const circle = new THREE.Mesh(geometryCircle, materialCircle);
      circle.rotation.x = Math.PI / 2;

      circle.position.x = 0;
      circle.position.y = -130;
      circle.position.z = 1000;
      scene.add(circle);

      //Middle circle
      var segmentCount = 32,
      radius = 100,
      geometrysss = new THREE.Geometry(),
      materialsss = new THREE.LineBasicMaterial({ color: 0xFFFFFF });

      var axis = new THREE.Vector3(0, 1, 0);
      var angle = Math.PI / 2;

      for (var i = 0; i <= segmentCount; i++) {
        var theta = (i / segmentCount) * Math.PI * 2;
        geometrysss.vertices.push(
          new THREE.Vector3(
            Math.cos(theta) * radius,
            Math.sin(theta) * radius,
            1000));
      }

      var circleDraw = new THREE.Line(geometrysss, materialsss)

      circleDraw.position.y = -1250;
      circleDraw.position.z = 0;//.. before 750

      circleDraw.rotateX((Math.PI) * -1 / 2);
      circleDraw.rotateY(0);
      circleDraw.rotateZ(0);

      scene.add(circleDraw);

      //funcion to draw corners
      function corner(positionx, positiony, positionz, rotatex, rotatey, rotatez) {
        var segmentCountCorner1 = 32,
        radiusCorner1 = 100,
        geometryCorner1 = new THREE.Geometry(),
        materialCorner1 = new THREE.LineBasicMaterial({ color: 0xFFFFFF });

        for (var i = 1; i <= segmentCountCorner1; i++) {
          var theta = (i / segmentCountCorner1) * Math.PI / 2;
          geometryCorner1.vertices.push(
            new THREE.Vector3(
              Math.cos(theta) * radiusCorner1,
              Math.sin(theta) * radiusCorner1,
              1000));
        }

        var circleDrawCorner1 = new THREE.Line(geometryCorner1, materialCorner1)

        circleDrawCorner1.position.x = positionx;
        circleDrawCorner1.position.y = positiony;
        circleDrawCorner1.position.z = positionz;

        circleDrawCorner1.rotateX(rotatex);
        circleDrawCorner1.rotateY(rotatey);
        circleDrawCorner1.rotateZ(rotatez);

        scene.add(circleDrawCorner1);
      }
      //drawing corners
      corner(-1000, -1250, -1500, (Math.PI) * -1 / 2, 0, 3 / 2 * Math.PI);
      corner(-1000, -1250, 1500, (Math.PI) * -1 / 2, 0, 0);
      corner(1000, -1250, 1500, (Math.PI) * -1 / 2, 0, 1 / 2 * Math.PI);
      corner(1000, -1250, -1500, (Math.PI) * -1 / 2, 0, Math.PI);
      //corner(800, -1250, -1500, (Math.PI) * -1 / 2, 0, Math.PI);

      //...areas
      function areafield(positionx, positiony, positionz, rotatex, rotatey, rotatez) {
        var segmentCountCorner1 = 32,
        radiusCorner1 = 500,
        geometryCorner1 = new THREE.Geometry(),
        materialCorner1 = new THREE.LineBasicMaterial({ color: 0xFFFFFF });

        for (var i = 1; i <= segmentCountCorner1; i++) {
          var theta = (i / segmentCountCorner1) * (Math.PI + 1 / 40 * Math.PI);
          geometryCorner1.vertices.push(
            new THREE.Vector3(
              Math.cos(theta) * radiusCorner1,
              Math.sin(theta) * radiusCorner1,
              1000));
        }

        var circleDrawCorner1 = new THREE.Line(geometryCorner1, materialCorner1)

        circleDrawCorner1.position.x = positionx;
        circleDrawCorner1.position.y = positiony;
        circleDrawCorner1.position.z = positionz;

        circleDrawCorner1.rotateX(rotatex);
        circleDrawCorner1.rotateY(rotatey);
        circleDrawCorner1.rotateZ(rotatez);

        scene.add(circleDrawCorner1);
      }
      //...areafield circle
      areafield(0, -1250, -1500, (Math.PI) * -1 / 2, 0, 1 * Math.PI - 1 / 30 * Math.PI)
      areafield(0, -1250, 1500, (Math.PI) * -1 / 2, 0, -2 * Math.PI - 1 / 30 * Math.PI)
      //...finish

      //...CylinderGeometry

      const geometryCylinder = new THREE.CylinderGeometry(100, 100, 1, 32);
      const materialCylinder = new THREE.MeshBasicMaterial({ wireframe: false, opacity: 0.5 });
      const cylinder = new THREE.Mesh(geometryCylinder, materialCylinder);
      cylinder.position.x = 0;
      cylinder.position.y = -250;
      cylinder.position.z = 1000;

      //  scene.add(cylinder);

      // controls
      const controls = new OrbitControls(camera, renderer.domElement);
      controls.maxPolarAngle = Math.PI * 0.5;
      controls.minDistance = 1000;
      controls.maxDistance = 12000;

      // performance monitor

      stats = new Stats();
      container.appendChild(stats.dom);

      //

      window.addEventListener('resize', onWindowResize, false);

      //

      const gui = new GUI();
      gui.add(params, 'enableWind').name('Enable wind');
      gui.add(params, 'showBall').name('Show ball');
      gui.add(params, 'togglePins').name('Toggle pins');
      //

      if (typeof TESTING !== 'undefined') {

        for (let i = 0; i < 50; i++) {

          simulate(500 - 10 * i);

        }

      }

    }

    //

    function onWindowResize() {

      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();

      renderer.setSize(window.innerWidth, window.innerHeight);

    }

    //

    function animate( now ) {
      renderJugadores(now);
      requestAnimationFrame( animate );
      simulate(now);
      render();
      stats.update();

    }

    function renderJugadores(now){
      now *= 0.001;  // convert to seconds
      const deltaTime = now - then;
      then = now;

      for (const mixer of mixers) {
        mixer.update(deltaTime);
      }
    }

    function render() {
      const p = cloth.particles;

      for (let i = 0, il = p.length; i < il; i++) {

        const v = p[i].position;

        clothGeometry.attributes.position.setXYZ(i, v.x, v.y, v.z);

      }

      clothGeometry.attributes.position.needsUpdate = true;

      clothGeometry.computeVertexNormals();

      sphere.position.copy(ballPosition);

      renderer.render( scene, camera );
    }

    requestAnimationFrame(render);

  </script>

</body>

</html>